
let debug = require('debug')('xsenv');
const secretKeys = ['certificate','key', 'verificationkey', 'clientsecret', 'password', 'usersecret'];

module.exports.redactServicesSecretData = redactServicesSecretData;

function redactServicesSecretData(serviceData) {
  if (!serviceData){
    return {};
  }
  debug('Redacting Services Secret Data');
  let services = JSON.parse(JSON.stringify(serviceData));

  if (!Object.keys(services) || Object.keys(services).length === 0){
    debug('Did not find any services keys in service data.');
    return;
  }

  for (let service in services){
    if (!services[service].credentials){
      return;
    }
    for (let sk in secretKeys){
      let skey = secretKeys[sk];
      if (services[service].credentials[skey]){
        services[service].credentials[skey] = 'redacted';
      }
    }
  }
  debug(services);
  return services;
}
